require 'grid_formatter'
require 'grid_builder'

describe GridFormatter do
  let(:test_grid) do
    GridBuilder.from_initial_state(["_@_",
                                    "__@",
                                    "@@@"])
  end
  describe "displaying a grid" do
    it "displays a grid as a string" do
      formatter_output = GridFormatter.as_string(test_grid)

      expected_output =<<-eos.gsub(/^\s+/, '')
      ============================================================
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |------------------------------@---------------------------|
      |-------------------------------@--------------------------|
      |-----------------------------@@@--------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      ============================================================
      eos
      expect(formatter_output).to eq(expected_output)
    end

    it "displays the grid's next generation as a string" do
      next_grid = test_grid.tick
      formatter_output = GridFormatter.as_string(next_grid)
      expected_output =<<-eos.gsub(/^\s+/, '')
      ============================================================
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |-----------------------------@-@--------------------------|
      |------------------------------@@--------------------------|
      |------------------------------@---------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      |----------------------------------------------------------|
      ============================================================
      eos
      expect(formatter_output).to eq(expected_output)
    end
  end
end
